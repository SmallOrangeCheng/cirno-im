# cirno-im
【施工中】  
Golang高性能分布式IM

对于该分布式IM，整体上来讲，系统被划分为三个层级：

1. SDK层 
2. 网关层
3. 逻辑服务层

为了保证通信效率的最大化，SDK层和网关层，网关层与逻辑服务层使用的协议可能不同。例如对于网关层可以使用ws tcp协议，但是网关和逻辑服务之间使用裸的tcp。对于不同协议之间的协调，存在着一定的复杂性。

1. 需要编写ws协议的通信逻辑用于网关层和web sdk的通信
2. 需要编写tcp协议的通信逻辑用于网关层与app sdk的通信
3. 需要编写tcp协议的通信逻辑用于网关层和逻辑服务层的通信

以上三种通信逻辑存在不小差异，例如对于ws协议，数据包的基本单位为Frame帧，但是TCP是数据流。对于拆包逻辑来讲，tcp和ws的差异也十分巨大，tcp是流式传输，所以一般是上层业务处理拆包，ws是基于frame，所以可以直接区分出每一个frame，在底层的server进行处理然后再传给上层业务。

我们需要对协议进行抽象，屏蔽掉tcp与ws之间的差异，这其实也就是通信层需要做的事情。

